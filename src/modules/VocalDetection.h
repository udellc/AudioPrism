//============================================================================
// MODULE INFORMATION
//============================================================================
// Name        : VocalDetection
// Return Type : int
// Description : Uses template of phonetic vowel sounds to compare against
//               input and determine if vocals are present. The current
//               implementation only looks for 5 vocal sounds.
//============================================================================

#ifndef Vocal_Detection_h
#define Vocal_Detection_h

#include "../AnalysisModule.h"
#include "./experimental/CrossCorrelation.h"

#include <cmath>
#include <cstdint>

// VocalDetection inherits from the ModuleInterface with an int output type
class VocalDetection : public ModuleInterface<int> {
private:
    // templates are preprocessed and windowed then hard coded into the module
    // each template contains 8 windows with a 256 sample rate
    uint16_t a_temp[8][129] = { { 38162, 31888, 108019, 85223, 114394, 102100, 47268, 55139, 61887, 113127, 59333, 108526, 36857, 230761, 156263, 159501, 177785, 64456, 133269, 50686, 110083, 40560, 169593, 97069, 95086, 102790, 32875, 42398, 7116, 12310, 8595, 23133, 14138, 15756, 8715, 15922, 19878, 8094, 11429, 4078, 8135, 4103, 12474, 8084, 6108, 6781, 4824, 7951, 3777, 9849, 2824, 4754, 2561, 606, 406, 646, 743, 1379, 2595, 998, 3263, 2871, 7095, 4108, 2656, 2093, 1507, 2440, 1238, 1014, 668, 730, 200, 602, 165, 519, 651, 483, 464, 401, 661, 366, 488, 193, 204, 359, 85, 268, 116, 210, 278, 203, 236, 507, 326, 517, 747, 608, 1600, 462, 975, 630, 314, 291, 738, 772, 1166, 1517, 327, 751, 137, 672, 274, 409, 381, 175, 184, 177, 120, 132, 182, 106, 87, 163, 194, 69, 14, 228, 10 }, { 39822, 45261, 121897, 91554, 131080, 108142, 61829, 60409, 87160, 122897, 86691, 116540, 108651, 249465, 146354, 211334, 172071, 131404, 142424, 102967, 126899, 117898, 192348, 77123, 168815, 94648, 38736, 25441, 32255, 28701, 20471, 22700, 17740, 21362, 17163, 30486, 17270, 14182, 10351, 10779, 10531, 12505, 15438, 7201, 12059, 6926, 9343, 6537, 10579, 7548, 6018, 6072, 1289, 464, 321, 1332, 968, 2076, 2572, 6363, 4907, 3317, 4359, 5141, 5182, 2610, 2351, 1418, 1229, 1309, 2250, 1387, 385, 350, 1412, 762, 1110, 268, 432, 865, 208, 790, 164, 575, 290, 471, 242, 498, 186, 520, 345, 408, 501, 389, 810, 108, 1133, 790, 570, 1577, 797, 888, 352, 300, 665, 1425, 795, 396, 652, 635, 552, 765, 409, 459, 430, 354, 428, 268, 386, 337, 250, 404, 300, 356, 314, 397, 325, 198, 517 }, { 33693, 53235, 121388, 76888, 130968, 110010, 60321, 61617, 91199, 127705, 79328, 124338, 130594, 244277, 173472, 237312, 193199, 155872, 152384, 117646, 151594, 149389, 213919, 130227, 204042, 106283, 39638, 17917, 35206, 33466, 24516, 24207, 20679, 18264, 20267, 30604, 20617, 14378, 10232, 8944, 9065, 15595, 13634, 8246, 10258, 8172, 9922, 8440, 10291, 8005, 8790, 5939, 2070, 1153, 1230, 1632, 1720, 1974, 6164, 11072, 8670, 5460, 5282, 6686, 6347, 2973, 4604, 1061, 1159, 821, 3919, 900, 1001, 1082, 1490, 472, 1032, 892, 1031, 531, 1245, 776, 979, 876, 837, 883, 724, 875, 749, 953, 787, 695, 1063, 597, 1262, 451, 1509, 465, 1339, 1145, 121, 1092, 708, 647, 1259, 515, 1369, 769, 1112, 400, 1506, 344, 1003, 522, 1053, 720, 944, 588, 827, 734, 680, 731, 708, 737, 656, 750, 679, 789, 618 }, { 35692, 37244, 125894, 49817, 128605, 103612, 48111, 61333, 83995, 132416, 52025, 120035, 112199, 258465, 182564, 215632, 174327, 162723, 144480, 92162, 138324, 129767, 203705, 132988, 184154, 109831, 38262, 18742, 37960, 35385, 17264, 21648, 12914, 24315, 13454, 25273, 12781, 14588, 9508, 7192, 6228, 12376, 12640, 9378, 10614, 4588, 10093, 5213, 11662, 7380, 7027, 6044, 1161, 1177, 867, 606, 762, 1841, 2027, 10291, 7950, 5370, 4917, 5732, 7360, 3382, 2369, 2075, 1793, 1269, 2095, 1907, 1034, 722, 403, 768, 605, 859, 105, 556, 406, 343, 453, 261, 346, 404, 228, 160, 604, 237, 433, 486, 195, 767, 494, 243, 942, 661, 1846, 745, 831, 226, 673, 182, 706, 580, 982, 619, 525, 768, 590, 245, 464, 456, 540, 401, 174, 372, 265, 352, 293, 178, 371, 141, 297, 301, 158, 376, 178 }, { 41272, 24201, 124349, 59683, 132831, 95426, 48898, 51715, 86960, 131957, 36437, 121328, 77437, 242478, 101193, 215992, 128158, 157437, 113478, 107718, 127928, 101135, 180996, 96804, 198993, 88284, 43961, 11999, 60031, 36793, 15931, 16667, 18882, 22809, 12011, 27580, 9522, 19738, 3807, 10620, 3399, 11802, 7259, 10935, 10182, 5068, 7672, 4953, 10873, 4898, 10354, 4256, 2055, 1277, 377, 168, 1191, 1075, 3018, 4527, 3549, 5190, 853, 6506, 3941, 4163, 2046, 1193, 1562, 435, 1015, 1258, 661, 601, 1048, 327, 163, 240, 723, 475, 292, 396, 104, 221, 56, 116, 65, 175, 144, 334, 120, 409, 77, 654, 548, 610, 213, 1258, 2168, 965, 523, 297, 567, 473, 551, 899, 1604, 1435, 213, 714, 637, 712, 144, 650, 512, 241, 136, 173, 166, 134, 81, 76, 174, 79, 15, 84, 173, 84, 26 }, { 37509, 31247, 125600, 86700, 135890, 98926, 58334, 54536, 98022, 131666, 64710, 116987, 69304, 231502, 29390, 211550, 77755, 152465, 104688, 120931, 116033, 105495, 150486, 80278, 188545, 48889, 48853, 22940, 58080, 29604, 23225, 12080, 21166, 21317, 21499, 28028, 4100, 16600, 5925, 13331, 5312, 9238, 1898, 13327, 8378, 7493, 6127, 6343, 8883, 5051, 11118, 1705, 3619, 1583, 306, 276, 1261, 1307, 4080, 4340, 3162, 3833, 5983, 10324, 2536, 2089, 1535, 3915, 2610, 1326, 638, 320, 934, 895, 1316, 41, 479, 99, 757, 290, 252, 133, 312, 137, 223, 58, 141, 198, 177, 286, 186, 258, 342, 574, 169, 438, 488, 1344, 1478, 491, 1123, 368, 759, 420, 550, 1008, 2221, 872, 951, 881, 546, 397, 444, 722, 352, 93, 108, 209, 130, 93, 63, 271, 42, 113, 104, 94, 52, 133, 89 }, { 36268, 48616, 123802, 102876, 134827, 111227, 63319, 63737, 106629, 138510, 95179, 123616, 94784, 232993, 89921, 210741, 121820, 139433, 124439, 115922, 125668, 118278, 166716, 73814, 184884, 48482, 52066, 37914, 55993, 39799, 20725, 15967, 18205, 23836, 23597, 29524, 9547, 16915, 8814, 11925, 8442, 12936, 7887, 7680, 10010, 6874, 8576, 5531, 9101, 4138, 12054, 4108, 3024, 1721, 917, 97, 1151, 1760, 3438, 5722, 2122, 1370, 5082, 10220, 5647, 2738, 416, 2888, 3121, 1508, 1647, 515, 821, 752, 1444, 617, 224, 292, 633, 589, 176, 412, 134, 507, 122, 427, 53, 606, 170, 545, 359, 283, 787, 522, 806, 939, 780, 1340, 2177, 352, 1809, 605, 429, 652, 571, 88, 1302, 1265, 893, 629, 368, 674, 101, 798, 221, 235, 258, 305, 210, 212, 229, 257, 323, 269, 181, 276, 193, 214, 389 }, { 36246, 52337, 123865, 91932, 132418, 113952, 64761, 69482, 106405, 146068, 96844, 133834, 128888, 243194, 153601, 217912, 163035, 132729, 133137, 126172, 141114, 128901, 190580, 122862, 207759, 87390, 23302, 34356, 46564, 41925, 21325, 26936, 15281, 23741, 20201, 33646, 15473, 17021, 14680, 11700, 9892, 13568, 15308, 8746, 13128, 5886, 11273, 4863, 11779, 5395, 10792, 7345, 916, 3455, 1944, 1158, 2250, 911, 4924, 4703, 3568, 1900, 1113, 10372, 3784, 2089, 1730, 2639, 3255, 2237, 1080, 795, 1697, 1348, 1830, 1338, 1228, 763, 1884, 564, 1375, 780, 1310, 840, 1093, 925, 1054, 931, 977, 905, 1151, 948, 1247, 547, 1394, 1108, 1439, 1825, 1813, 1493, 434, 1850, 1416, 809, 1156, 1139, 583, 2228, 689, 1973, 965, 1162, 1143, 571, 1387, 714, 1215, 780, 928, 765, 860, 859, 848, 892, 805, 885, 864, 834, 882 } };

    uint16_t e_temp[8][129] = { { 33381, 47287, 108959, 53808, 171444, 141301, 242018, 272362, 127692, 107914, 30741, 31548, 10364, 6391, 5958, 6390, 6082, 2102, 3748, 1995, 2672, 3693, 2971, 2520, 2028, 3667, 2298, 2752, 4456, 4497, 5525, 1450, 15951, 21691, 38253, 25900, 7960, 26088, 25324, 27577, 13699, 10429, 15596, 30586, 21601, 7971, 2315, 8120, 11326, 7749, 7654, 5117, 10754, 9702, 10440, 4719, 13117, 13743, 7702, 3777, 1359, 797, 66, 88, 168, 72, 294, 218, 93, 162, 209, 1183, 2099, 1170, 528, 405, 310, 362, 292, 413, 347, 487, 18, 114, 99, 245, 216, 484, 191, 174, 261, 776, 632, 339, 208, 299, 406, 567, 521, 286, 1434, 1330, 1287, 243, 73, 120, 129, 0, 251, 119, 61, 137, 228, 345, 506, 496, 466, 46, 258, 327, 606, 306, 356, 120, 166, 197, 285, 15, 133 }, { 41719, 28997, 135708, 52239, 195562, 163796, 242727, 324392, 128123, 112291, 24679, 21494, 16187, 5508, 5382, 8831, 5550, 2567, 6496, 1932, 4190, 3782, 4607, 2896, 5130, 2042, 3868, 2741, 4226, 6574, 4073, 7832, 11502, 48534, 53125, 64292, 34944, 25489, 33989, 11513, 6484, 17348, 28084, 15028, 4391, 9510, 12790, 13320, 3523, 10367, 8848, 10070, 3712, 14425, 9783, 15691, 12074, 6842, 6605, 2658, 2161, 894, 438, 457, 537, 503, 349, 524, 368, 517, 1319, 1037, 1177, 449, 532, 1183, 486, 776, 371, 333, 1075, 470, 418, 335, 548, 344, 103, 664, 120, 639, 504, 149, 797, 406, 354, 798, 319, 564, 232, 631, 1035, 515, 861, 531, 207, 407, 373, 305, 384, 465, 298, 324, 668, 333, 725, 318, 243, 794, 284, 443, 405, 224, 344, 379, 408, 379, 222, 441, 325 }, { 41558, 31454, 155708, 111287, 230351, 195097, 247579, 352075, 104783, 131097, 47876, 28553, 12651, 9127, 8680, 10541, 10300, 346, 5039, 2277, 5730, 2282, 3358, 2681, 6780, 5850, 478, 2978, 4882, 10665, 4219, 9504, 8695, 55293, 48133, 32063, 29326, 24725, 54046, 24456, 21533, 16973, 42249, 36259, 20597, 30061, 15215, 13084, 14693, 23536, 9827, 8024, 654, 27150, 28759, 13242, 14663, 1185, 13046, 5702, 1640, 1105, 227, 54, 269, 171, 355, 461, 679, 1769, 2311, 2726, 2549, 1010, 1171, 348, 565, 568, 1236, 955, 263, 272, 199, 270, 209, 549, 878, 1027, 576, 151, 811, 1641, 1681, 1123, 1330, 771, 982, 1415, 2608, 1546, 1515, 2575, 983, 679, 194, 133, 48, 53, 119, 25, 140, 382, 454, 107, 459, 953, 919, 22, 570, 241, 603, 394, 326, 407, 262, 290, 209, 237, 290 }, { 33936, 56771, 168786, 154068, 254328, 250709, 277941, 377397, 26640, 136605, 69132, 28486, 15393, 12077, 9132, 13562, 11068, 4886, 8523, 1901, 7208, 552, 2536, 7263, 4033, 8155, 1512, 4423, 7235, 8654, 8676, 8087, 8730, 44545, 62068, 20340, 55572, 43659, 57636, 38777, 18085, 6645, 27402, 44264, 18765, 3801, 10568, 27920, 21202, 20124, 10171, 12712, 23876, 14598, 23702, 7562, 23507, 15482, 7528, 2996, 462, 2046, 666, 767, 993, 895, 751, 1094, 1700, 792, 2443, 2690, 3976, 1235, 1526, 686, 645, 1822, 563, 1506, 309, 1189, 523, 964, 193, 1372, 672, 1477, 624, 335, 1614, 834, 2639, 888, 196, 1595, 790, 1687, 1509, 967, 4732, 5625, 2222, 1023, 692, 513, 669, 706, 593, 546, 924, 211, 1138, 401, 1182, 1468, 914, 801, 391, 1140, 351, 989, 237, 905, 463, 827, 344, 694, 684 }, { 31902, 60974, 177073, 132777, 255764, 289476, 296198, 410082, 131047, 128608, 67218, 33457, 11499, 12372, 9229, 13236, 10146, 8628, 5451, 7678, 5659, 4294, 2375, 6891, 5008, 5417, 4750, 5150, 7842, 7577, 9987, 11327, 21296, 35224, 84529, 39631, 30103, 49218, 53312, 55187, 31684, 23285, 19269, 49393, 35885, 18507, 6032, 10588, 18678, 18426, 15261, 8523, 24513, 26115, 21538, 19555, 9505, 19427, 9600, 2510, 2879, 935, 1302, 1171, 1025, 888, 1301, 481, 2477, 2072, 1605, 2669, 1338, 2022, 1660, 429, 851, 1390, 1190, 676, 1309, 531, 1120, 904, 627, 1217, 1123, 67, 1449, 767, 1207, 805, 2735, 1207, 1626, 102, 1844, 1603, 3829, 854, 3360, 2940, 1850, 1254, 882, 746, 688, 782, 679, 756, 727, 675, 649, 1142, 303, 601, 1383, 484, 991, 593, 655, 831, 636, 861, 634, 885, 497, 1018, 403 }, { 43512, 38668, 183471, 97320, 254473, 282406, 252092, 410547, 164438, 129373, 65493, 22775, 16719, 8812, 12710, 5006, 12676, 2540, 8569, 4711, 4517, 3921, 1582, 4448, 2242, 4313, 1979, 6879, 5294, 7824, 7232, 12173, 22921, 25912, 75601, 49880, 30308, 35395, 29045, 47151, 12951, 23831, 18568, 48128, 30784, 10988, 6993, 8490, 16260, 9133, 14186, 7630, 26909, 21227, 22118, 21865, 8775, 17442, 9157, 2689, 1570, 474, 443, 17, 277, 385, 198, 498, 1508, 1353, 1760, 2363, 1637, 1257, 545, 397, 226, 990, 703, 845, 846, 197, 328, 337, 703, 391, 503, 429, 597, 578, 533, 1264, 629, 1271, 499, 923, 549, 608, 1189, 772, 2534, 3741, 1594, 830, 218, 29, 171, 122, 201, 34, 207, 320, 267, 730, 650, 422, 406, 332, 420, 68, 143, 218, 405, 101, 188, 74, 260, 232, 18 }, { 37064, 36692, 182137, 132389, 248493, 254158, 199210, 424688, 137643, 156208, 74512, 24016, 20093, 7894, 11399, 3471, 12858, 2748, 8789, 4486, 2688, 3075, 4109, 4305, 702, 4663, 1251, 5317, 3492, 6797, 8661, 15093, 22852, 20036, 80762, 36266, 24447, 21824, 22589, 34179, 13745, 27104, 7705, 43465, 19482, 20245, 14885, 6022, 15456, 3337, 13551, 1594, 22743, 14045, 20381, 20506, 8148, 22064, 6635, 4173, 1639, 260, 254, 282, 268, 178, 125, 788, 1675, 1311, 3306, 2522, 1028, 237, 301, 324, 464, 334, 323, 478, 249, 162, 277, 301, 475, 298, 783, 690, 524, 445, 474, 1329, 360, 1169, 233, 606, 1007, 1130, 1981, 745, 3275, 2999, 1351, 380, 180, 243, 26, 23, 34, 31, 15, 173, 128, 378, 427, 272, 547, 58, 388, 180, 188, 214, 138, 286, 54, 230, 108, 48, 7 }, { 40793, 49899, 179773, 145429, 253219, 268566, 267469, 408889, 82394, 153010, 87398, 23880, 24199, 6504, 12694, 6413, 13839, 6436, 8874, 6567, 3781, 5111, 2342, 6500, 1278, 5672, 1457, 4927, 2993, 6084, 8074, 15048, 26087, 26868, 87568, 42264, 30072, 29155, 16872, 21603, 15485, 29676, 15697, 35926, 21665, 18670, 24012, 16359, 17441, 10123, 14250, 7752, 17346, 11675, 14681, 16052, 13137, 23369, 5488, 4192, 1976, 504, 806, 833, 372, 733, 793, 611, 759, 472, 3570, 2780, 1794, 577, 818, 499, 502, 830, 736, 871, 362, 608, 498, 627, 312, 608, 474, 823, 738, 804, 441, 204, 854, 1082, 958, 869, 365, 1809, 1183, 776, 2867, 40, 1924, 825, 429, 526, 300, 580, 420, 388, 488, 429, 417, 714, 258, 449, 538, 372, 713, 369, 261, 483, 597, 90, 679, 305, 466, 445, 349 } };

    uint16_t i_temp[8][129] = { { 33559, 51566, 172672, 129963, 183492, 243365, 59557, 9866, 5897, 4609, 6279, 2644, 3442, 1534, 1546, 1231, 344, 1815, 872, 854, 1090, 204, 1194, 1088, 1158, 981, 531, 1157, 270, 965, 734, 927, 2257, 1771, 2773, 3979, 3814, 12046, 3745, 13009, 15384, 4446, 4310, 1543, 1147, 2003, 2750, 2822, 2404, 4868, 6783, 12947, 4604, 27968, 25547, 4821, 9909, 4015, 17800, 9461, 686, 612, 980, 2470, 896, 1522, 899, 429, 189, 243, 418, 835, 680, 225, 898, 792, 679, 406, 316, 339, 146, 785, 441, 453, 57, 612, 412, 478, 390, 90, 907, 925, 308, 682, 211, 534, 542, 220, 530, 285, 1096, 199, 682, 546, 184, 172, 191, 213, 188, 242, 220, 220, 265, 338, 149, 166, 270, 105, 257, 104, 229, 218, 147, 215, 156, 190, 208, 152, 234 }, { 39137, 49133, 186388, 163810, 220313, 273203, 57217, 14661, 4939, 8558, 5780, 1775, 6182, 2833, 3308, 2445, 2429, 2696, 1581, 2840, 1217, 2444, 1018, 2731, 1164, 1240, 1832, 1173, 2110, 844, 1791, 1111, 2201, 3051, 1897, 6020, 4471, 14667, 9272, 9710, 15113, 3635, 5271, 4454, 2453, 1710, 2551, 5147, 3118, 4918, 5142, 15457, 15408, 23658, 26986, 7810, 13006, 10873, 8626, 6943, 1829, 1065, 1950, 1576, 1047, 614, 1895, 1075, 1552, 1233, 953, 998, 1802, 1605, 700, 1427, 231, 1143, 494, 659, 438, 1051, 291, 677, 868, 253, 819, 593, 484, 890, 781, 1383, 95, 801, 704, 823, 172, 793, 562, 703, 824, 1232, 956, 508, 440, 560, 474, 506, 549, 418, 596, 389, 702, 322, 668, 519, 494, 485, 415, 540, 511, 469, 505, 445, 494, 501, 447, 512, 443 }, { 40404, 25493, 190438, 141102, 209785, 293169, 59684, 17421, 7005, 10144, 4273, 719, 5168, 1197, 2250, 1720, 3017, 1081, 887, 2043, 1133, 453, 1148, 1809, 198, 308, 1853, 756, 203, 1022, 1774, 668, 506, 3040, 1761, 5661, 4638, 11910, 13019, 9023, 12496, 3914, 5664, 2429, 2215, 3574, 2640, 5220, 224, 7574, 4230, 16322, 20100, 19791, 35618, 7532, 12104, 8375, 3244, 5352, 245, 1191, 993, 2183, 1027, 1140, 1707, 174, 614, 570, 624, 185, 806, 532, 397, 840, 474, 256, 629, 560, 231, 850, 320, 482, 951, 398, 352, 951, 183, 623, 711, 790, 1327, 612, 203, 295, 679, 192, 125, 1155, 738, 1267, 356, 335, 299, 307, 297, 334, 338, 255, 199, 647, 119, 501, 338, 211, 391, 322, 246, 277, 439, 206, 301, 301, 281, 290, 284, 298, 300 }, { 34138, 50798, 182969, 145746, 198433, 299720, 82380, 14344, 9199, 4737, 9199, 1435, 5791, 881, 1607, 1738, 1966, 3015, 666, 2345, 755, 1628, 779, 692, 1694, 377, 2115, 206, 1611, 391, 1787, 1565, 1180, 2684, 1502, 7092, 6019, 8555, 19775, 4226, 9399, 6878, 4259, 6595, 1913, 4666, 2148, 6406, 5449, 6782, 12048, 9750, 31759, 14409, 18036, 18768, 13051, 21454, 7348, 599, 1289, 896, 329, 939, 1012, 1980, 3046, 1481, 1259, 1236, 1329, 728, 960, 899, 255, 363, 401, 413, 644, 264, 975, 1174, 350, 665, 507, 420, 1009, 722, 592, 566, 822, 966, 981, 663, 703, 193, 565, 64, 796, 503, 413, 608, 273, 270, 263, 304, 280, 249, 359, 261, 278, 331, 58, 462, 388, 181, 403, 144, 323, 249, 278, 382, 179, 292, 235, 280, 286, 243, 288 }, { 36668, 41817, 175620, 158825, 211037, 306402, 74905, 18020, 15595, 4181, 10748, 3721, 5526, 3369, 3471, 2545, 3470, 3097, 2703, 875, 2719, 2175, 1808, 1927, 925, 2075, 1094, 1647, 2335, 295, 1793, 1890, 878, 4919, 2146, 4560, 7755, 9029, 20952, 12570, 5909, 5349, 6110, 7719, 2892, 7674, 5738, 6488, 7136, 6264, 15225, 12607, 27621, 27492, 13927, 20269, 11320, 19133, 10228, 3306, 4578, 1641, 2287, 727, 3522, 820, 1034, 3151, 669, 1151, 850, 2447, 2686, 670, 1239, 486, 775, 455, 552, 860, 728, 493, 717, 250, 1071, 461, 976, 7, 1403, 1160, 715, 1458, 639, 1641, 169, 734, 787, 260, 1113, 81, 1695, 182, 615, 596, 547, 494, 531, 526, 579, 364, 821, 293, 808, 539, 723, 424, 441, 526, 558, 540, 562, 545, 447, 533, 491, 490, 545, 490, 506 }, { 41841, 25188, 169492, 130304, 184191, 305112, 84605, 25772, 12480, 6685, 7788, 4134, 5161, 2665, 1029, 1201, 2363, 2738, 751, 999, 164, 1058, 1071, 419, 877, 196, 656, 368, 772, 1044, 492, 1340, 494, 3446, 2796, 5782, 8820, 6606, 25395, 16980, 7961, 6224, 4652, 7473, 2747, 5480, 3990, 5502, 7709, 4900, 16320, 3611, 35116, 32289, 9401, 12626, 197, 13005, 8172, 3163, 5494, 1583, 2390, 1668, 2817, 2336, 3397, 4231, 1960, 1419, 815, 2576, 2163, 741, 891, 868, 481, 435, 348, 566, 659, 708, 661, 1110, 1076, 360, 242, 227, 831, 769, 541, 258, 1038, 1016, 735, 297, 384, 550, 979, 267, 1133, 1022, 391, 213, 122, 109, 70, 91, 156, 250, 431, 541, 519, 462, 389, 84, 30, 84, 155, 210, 182, 6, 157, 79, 108, 73, 95, 91, 61 }, { 37210, 48419, 171391, 141331, 219183, 307341, 81708, 23578, 10440, 9360, 4377, 6376, 2567, 2602, 3031, 1433, 776, 3672, 550, 2238, 701, 2010, 579, 1613, 637, 1250, 413, 1434, 293, 1600, 293, 2232, 1073, 4344, 2154, 6981, 4901, 12322, 17216, 4292, 8612, 4674, 4970, 3886, 3813, 4739, 3825, 6338, 5355, 9207, 10328, 15410, 26253, 4357, 17472, 13907, 14378, 15009, 5060, 6316, 2809, 388, 85, 1623, 3366, 728, 2486, 2037, 1453, 706, 1035, 1401, 1388, 606, 808, 282, 159, 650, 324, 385, 584, 116, 1459, 855, 1011, 511, 514, 932, 883, 870, 906, 509, 467, 636, 128, 476, 328, 210, 88, 247, 487, 632, 217, 242, 342, 268, 277, 349, 334, 244, 331, 119, 605, 407, 237, 384, 202, 482, 149, 446, 137, 373, 287, 308, 267, 299, 268, 298, 264 } };

    uint16_t o_temp[8][129] = { { 42298, 28895, 84219, 62174, 129007, 143304, 236905, 342573, 66926, 97528, 71802, 115624, 96227, 7784, 10387, 7094, 7945, 5943, 1704, 2529, 1577, 1769, 1331, 2060, 834, 240, 1108, 1121, 1659, 737, 688, 682, 2670, 2427, 4580, 1976, 1064, 1677, 987, 1611, 434, 461, 204, 693, 762, 571, 94, 1153, 1327, 866, 771, 382, 315, 119, 134, 239, 146, 140, 70, 366, 8, 159, 563, 1608, 3321, 1737, 2198, 2146, 2141, 1127, 355, 243, 228, 49, 110, 98, 85, 82, 62, 86, 88, 101, 61, 81, 57, 102, 80, 120, 67, 208, 24, 96, 185, 410, 583, 853, 711, 500, 331, 962, 328, 537, 660, 1343, 1404, 630, 547, 207, 69, 61, 417, 378, 392, 272, 112, 368, 193, 270, 113, 86, 87, 146, 286, 208, 143, 76, 61, 68, 68 }, { 36382, 28002, 96906, 58738, 140017, 175625, 210726, 358330, 138097, 90879, 55357, 110789, 108988, 23658, 18390, 6439, 8168, 3419, 983, 1330, 1262, 1897, 523, 1681, 81, 1059, 562, 363, 1076, 303, 1303, 1480, 3231, 2712, 3526, 3630, 908, 1267, 244, 494, 340, 299, 592, 428, 1046, 934, 2017, 969, 343, 43, 322, 368, 55, 388, 127, 151, 177, 274, 150, 366, 378, 279, 272, 586, 2164, 1559, 628, 2020, 1397, 626, 158, 242, 179, 115, 211, 141, 146, 147, 153, 140, 160, 140, 125, 159, 133, 148, 145, 78, 155, 98, 215, 135, 328, 259, 735, 532, 499, 871, 445, 1334, 1012, 1800, 1779, 1189, 629, 502, 232, 201, 274, 137, 354, 264, 233, 192, 429, 291, 219, 153, 94, 95, 160, 220, 257, 133, 347, 84, 149, 91, 114 }, { 37649, 12078, 111368, 78949, 160031, 194097, 163964, 394091, 148398, 87125, 51987, 92924, 103504, 30853, 24917, 6865, 8284, 5415, 2112, 1436, 142, 2132, 449, 748, 1078, 1052, 80, 459, 1553, 412, 1140, 273, 3497, 2473, 2313, 3481, 94, 980, 364, 987, 211, 126, 547, 655, 719, 708, 1613, 1002, 443, 199, 66, 442, 201, 151, 301, 196, 209, 371, 201, 322, 612, 299, 68, 687, 1411, 1963, 750, 1515, 993, 57, 261, 166, 232, 155, 129, 203, 155, 160, 163, 147, 150, 174, 133, 145, 204, 115, 141, 171, 470, 121, 71, 238, 395, 422, 697, 963, 436, 725, 568, 818, 1076, 2194, 1351, 633, 431, 289, 332, 290, 348, 319, 128, 604, 61, 579, 846, 62, 234, 219, 175, 71, 119, 171, 195, 47, 177, 91, 136, 109, 125 }, { 37182, 41700, 120225, 108438, 183526, 212765, 212520, 427096, 126541, 101348, 75709, 83345, 83443, 13940, 32143, 12889, 10749, 5171, 4091, 679, 3068, 1970, 1595, 2828, 778, 2278, 1038, 1773, 1709, 1281, 2513, 398, 4057, 1706, 2142, 4561, 505, 1081, 1414, 208, 1519, 474, 1319, 1139, 1322, 1303, 758, 1226, 1503, 304, 1125, 437, 808, 824, 675, 788, 650, 699, 711, 851, 676, 634, 933, 401, 1613, 2483, 286, 1209, 685, 438, 682, 638, 510, 612, 553, 611, 534, 554, 560, 560, 527, 556, 505, 541, 535, 509, 491, 799, 176, 489, 597, 526, 389, 885, 543, 519, 1034, 330, 1376, 1010, 654, 3014, 1563, 741, 1091, 223, 840, 228, 719, 172, 701, 586, 207, 1149, 379, 508, 704, 220, 769, 309, 550, 379, 394, 547, 437, 465, 423, 432, 453 }, { 32450, 44261, 124109, 86731, 182553, 218149, 283472, 449690, 172414, 103789, 66392, 82195, 65846, 19095, 31436, 10232, 9594, 4542, 2833, 2190, 2117, 1723, 1109, 954, 1206, 579, 928, 912, 1465, 1449, 1521, 2100, 3868, 3936, 5479, 4267, 529, 571, 456, 1274, 126, 502, 541, 1009, 1051, 1056, 1386, 707, 624, 561, 422, 201, 358, 105, 287, 112, 178, 349, 99, 653, 376, 429, 433, 1032, 3113, 2037, 344, 589, 475, 308, 336, 67, 199, 199, 164, 179, 152, 160, 164, 151, 149, 168, 134, 139, 177, 107, 272, 319, 516, 334, 443, 204, 473, 591, 1373, 432, 760, 479, 818, 539, 713, 616, 59, 426, 332, 122, 365, 45, 377, 161, 417, 441, 509, 829, 617, 507, 248, 281, 53, 251, 116, 259, 29, 368, 200, 192, 91, 118, 165 }, { 41014, 14935, 126464, 77960, 174657, 219869, 220159, 460362, 181531, 92114, 54880, 66207, 76971, 29426, 30035, 7538, 8830, 4745, 2481, 2533, 136, 2990, 1284, 816, 1603, 1612, 768, 826, 2040, 1037, 1591, 1709, 3220, 3727, 4210, 4558, 1045, 1230, 655, 1116, 408, 477, 921, 849, 483, 1063, 1226, 1363, 609, 331, 426, 769, 413, 430, 469, 485, 459, 188, 787, 353, 988, 365, 452, 959, 2967, 2597, 144, 164, 718, 271, 466, 332, 407, 334, 344, 369, 313, 392, 303, 352, 355, 303, 353, 310, 311, 323, 396, 361, 274, 537, 10, 303, 568, 369, 751, 415, 535, 507, 301, 984, 1613, 1105, 1505, 294, 520, 381, 244, 346, 376, 268, 205, 701, 403, 684, 645, 87, 574, 439, 28, 325, 406, 235, 237, 417, 204, 461, 235, 288, 306 }, { 36379, 34702, 119191, 106961, 179102, 222477, 175257, 462220, 167132, 91010, 65072, 70827, 86099, 21064, 26813, 13940, 7939, 6373, 2192, 2588, 1278, 1404, 1005, 1852, 679, 1084, 573, 745, 1937, 594, 2370, 605, 3233, 4460, 1517, 3497, 1741, 919, 801, 998, 202, 702, 551, 286, 1286, 182, 776, 1606, 116, 220, 308, 253, 373, 343, 254, 306, 249, 426, 393, 480, 773, 514, 663, 1037, 2363, 1928, 914, 1399, 479, 257, 359, 270, 207, 213, 253, 209, 224, 256, 182, 241, 214, 227, 205, 232, 192, 253, 241, 74, 566, 353, 183, 491, 641, 728, 599, 512, 206, 604, 507, 77, 1359, 900, 429, 531, 453, 237, 344, 277, 103, 549, 121, 567, 487, 362, 935, 407, 278, 420, 276, 240, 347, 222, 278, 255, 210, 192, 190, 172, 192 }, { 33512, 41933, 117715, 93992, 170126, 222474, 244320, 466631, 202995, 82739, 64360, 74009, 85465, 17884, 29548, 12454, 7721, 5339, 2608, 3210, 1383, 2306, 897, 1756, 912, 1129, 263, 1369, 1156, 1369, 1586, 1819, 3541, 5188, 2016, 3599, 1161, 1418, 425, 927, 271, 685, 729, 820, 1023, 996, 906, 1730, 120, 283, 365, 434, 194, 352, 235, 297, 352, 91, 806, 106, 742, 596, 831, 1171, 1549, 1211, 766, 1357, 1003, 512, 199, 239, 250, 193, 214, 237, 190, 233, 210, 219, 193, 216, 198, 221, 191, 183, 279, 260, 278, 584, 203, 389, 512, 1164, 651, 601, 107, 329, 321, 671, 1114, 1807, 1396, 904, 444, 556, 138, 340, 63, 354, 74, 197, 67, 417, 450, 434, 169, 371, 103, 305, 87, 315, 103, 456, 48, 228, 179, 169, 142 } };

    uint16_t u_temp[8][129] = { { 35696, 38094, 105001, 97784, 226730, 313547, 74005, 19557, 15191, 40804, 41614, 42106, 67764, 23704, 4269, 2605, 3892, 1962, 2496, 2232, 1311, 2732, 919, 1639, 1554, 1358, 1286, 1124, 1263, 1071, 1378, 900, 1041, 921, 1151, 892, 883, 1296, 738, 286, 1623, 472, 1149, 605, 735, 858, 526, 963, 825, 296, 920, 680, 595, 718, 615, 616, 684, 643, 456, 676, 628, 568, 611, 428, 632, 493, 690, 640, 385, 757, 389, 1213, 334, 570, 503, 528, 472, 475, 500, 520, 459, 455, 469, 465, 478, 423, 469, 455, 457, 437, 434, 446, 429, 434, 427, 533, 195, 592, 494, 485, 353, 468, 413, 382, 433, 474, 346, 485, 392, 507, 381, 395, 450, 357, 496, 306, 427, 426, 331, 495, 391, 431, 475, 255, 544, 372, 391, 393, 390 }, { 34488, 38876, 124967, 109926, 254474, 310254, 48992, 31959, 1719, 47386, 32018, 49524, 70396, 9295, 5840, 5298, 3247, 2574, 3324, 1983, 2811, 949, 2106, 1427, 1572, 1668, 1315, 1491, 1308, 1382, 998, 1459, 1023, 1274, 1193, 862, 1273, 475, 1342, 1104, 1443, 789, 1057, 848, 934, 800, 914, 723, 1023, 677, 830, 705, 727, 714, 752, 675, 707, 701, 709, 726, 646, 608, 704, 593, 691, 495, 647, 719, 491, 420, 996, 426, 706, 470, 593, 527, 570, 541, 525, 542, 520, 556, 511, 500, 501, 516, 523, 508, 469, 520, 440, 535, 469, 496, 468, 502, 395, 612, 386, 630, 324, 551, 390, 531, 494, 391, 653, 450, 382, 408, 523, 382, 459, 493, 493, 321, 613, 278, 578, 582, 614, 634, 549, 554, 363, 572, 423, 406, 460 }, { 42560, 15226, 134504, 93282, 232232, 343472, 94590, 26759, 18207, 36212, 31280, 45441, 68610, 18345, 4836, 3468, 1851, 878, 616, 1782, 267, 383, 639, 472, 459, 373, 413, 354, 236, 564, 328, 56, 262, 463, 179, 172, 376, 933, 907, 684, 263, 349, 390, 236, 194, 350, 258, 192, 422, 126, 185, 167, 161, 164, 100, 134, 264, 29, 201, 144, 140, 106, 205, 20, 209, 108, 208, 165, 77, 160, 470, 318, 144, 47, 203, 33, 198, 98, 96, 125, 117, 73, 111, 103, 99, 86, 113, 68, 136, 78, 88, 77, 109, 108, 160, 90, 108, 47, 116, 207, 97, 85, 112, 157, 108, 131, 218, 167, 167, 235, 36, 157, 67, 104, 178, 99, 48, 107, 270, 106, 227, 464, 77, 162, 100, 64, 118, 90, 68 }, { 38150, 36394, 138535, 125042, 231633, 380074, 119325, 22653, 14172, 33509, 49913, 43665, 82002, 29835, 997, 4570, 1545, 2609, 1177, 1376, 1903, 632, 1993, 997, 1634, 894, 1215, 969, 974, 850, 904, 1061, 683, 914, 747, 899, 250, 885, 2017, 991, 975, 538, 784, 609, 666, 693, 443, 576, 715, 529, 564, 559, 503, 606, 468, 525, 538, 419, 686, 410, 417, 528, 434, 534, 365, 462, 425, 368, 625, 113, 693, 248, 501, 421, 294, 603, 281, 383, 406, 348, 424, 352, 375, 388, 362, 366, 366, 367, 372, 343, 350, 391, 308, 406, 256, 402, 396, 289, 428, 235, 396, 256, 423, 344, 330, 395, 122, 563, 277, 329, 328, 294, 331, 352, 327, 346, 305, 323, 228, 332, 420, 344, 371, 219, 350, 340, 305, 305, 310 }, { 37611, 13687, 135963, 131389, 182759, 403202, 155086, 22762, 17132, 29069, 55284, 32573, 58457, 44474, 6428, 6288, 2151, 1189, 1737, 305, 884, 615, 888, 713, 244, 523, 288, 563, 211, 442, 529, 212, 286, 92, 213, 427, 307, 895, 697, 722, 611, 150, 354, 85, 57, 216, 42, 287, 114, 124, 103, 88, 73, 73, 95, 76, 160, 196, 212, 163, 204, 32, 108, 116, 105, 148, 143, 360, 143, 343, 145, 98, 48, 13, 234, 90, 43, 48, 82, 48, 63, 24, 79, 6, 56, 55, 58, 39, 52, 32, 44, 58, 0, 136, 91, 154, 95, 122, 133, 35, 56, 153, 124, 76, 163, 62, 107, 62, 147, 92, 69, 96, 34, 108, 72, 59, 113, 50, 86, 17, 201, 114, 49, 61, 42, 61, 62, 63, 74 }, { 37382, 31443, 132333, 132816, 184934, 420175, 183108, 23780, 20211, 20080, 55690, 19044, 37198, 39779, 6373, 6495, 3114, 1410, 2285, 731, 564, 546, 938, 519, 530, 766, 347, 806, 281, 462, 740, 441, 689, 42, 557, 117, 446, 1222, 1099, 424, 584, 342, 440, 178, 366, 113, 312, 472, 78, 271, 289, 192, 216, 328, 145, 318, 248, 117, 503, 129, 170, 272, 219, 306, 257, 207, 383, 140, 501, 193, 227, 140, 173, 241, 186, 218, 159, 162, 225, 137, 183, 133, 200, 117, 171, 182, 123, 179, 148, 183, 113, 154, 141, 220, 248, 186, 150, 241, 53, 251, 109, 127, 170, 104, 223, 222, 81, 327, 69, 321, 74, 252, 191, 193, 206, 136, 212, 77, 349, 43, 204, 290, 202, 141, 143, 123, 165, 133, 152 }, { 37748, 12198, 133409, 129911, 184359, 427145, 178138, 17612, 17819, 24917, 50262, 25038, 35230, 35927, 5508, 6087, 2856, 893, 1854, 418, 949, 661, 793, 822, 561, 188, 444, 831, 296, 510, 686, 427, 599, 88, 321, 488, 617, 1231, 1324, 223, 386, 369, 307, 208, 144, 471, 172, 372, 121, 235, 243, 180, 190, 223, 285, 68, 318, 283, 486, 202, 248, 212, 230, 254, 76, 321, 209, 322, 447, 320, 131, 260, 135, 175, 298, 93, 211, 181, 134, 162, 148, 147, 188, 106, 176, 122, 189, 126, 126, 163, 142, 163, 47, 116, 197, 164, 185, 88, 185, 292, 164, 272, 63, 194, 369, 322, 446, 138, 201, 264, 241, 313, 30, 120, 267, 49, 150, 139, 90, 261, 117, 169, 71, 197, 190, 100, 119, 121, 178 }, { 36233, 35976, 136742, 131678, 197002, 411902, 161216, 19677, 14480, 20934, 44092, 6391, 44366, 35707, 5464, 5957, 2524, 702, 1824, 1664, 594, 1325, 1538, 903, 967, 778, 826, 715, 830, 351, 1030, 617, 680, 492, 841, 428, 213, 1714, 229, 217, 998, 260, 705, 440, 286, 641, 411, 566, 363, 438, 397, 345, 429, 347, 477, 317, 291, 521, 364, 399, 346, 390, 245, 387, 309, 367, 384, 390, 245, 606, 296, 402, 284, 231, 504, 273, 242, 284, 312, 286, 254, 292, 267, 241, 305, 219, 302, 287, 235, 249, 260, 250, 266, 201, 304, 205, 389, 162, 286, 220, 224, 397, 157, 348, 111, 292, 356, 182, 110, 347, 150, 314, 212, 211, 214, 187, 310, 205, 286, 221, 186, 424, 239, 202, 278, 210, 271, 201, 254 } };

    // CrossCorrelation is the class that performs the template matching with one instance for each template
    CrossCorrelation data[5];

public:
    // constructor
    // a constructor is used to initialize the templates so they are ready for use
    VocalDetection();
    // Take in the 8 most recent sample windows and compares them to the different templates
    // the threshold that is the highest is what determines the output int.
    // output = {0: No Vocals, 1: a, 2: e, 3: i, 4: o, 5: u}
    void doAnalysis();

    void printTemplate();
};

#endif
